# 工商银行/建设银行 配对交易研究 - 快速导航

## 📋 项目概览

**研究对象**: 工商银行(601398.SH) vs 建设银行(601939.SH)  
**研究方法**: 严格复现宁德时代/比亚迪配对交易研究流程  
**数据周期**: 2020-01-02 至 2025-12-31 (1455个交易日)  
**研究成果**: 完整防泄露特征数据集 + 协整检验报告  

---

## 🚀 快速开始

### 1️⃣ 查看研究结果（1分钟）
```bash
python view_results.py
```
显示：数据划分、协整检验、特征统计

### 2️⃣ 查看详细报告（3分钟）
阅读以下文档（按顺序）：
1. [EXECUTION_REPORT.md](EXECUTION_REPORT.md) - 执行完成报告
2. [RESEARCH_SUMMARY.md](RESEARCH_SUMMARY.md) - 详细研究总结

### 3️⃣ 访问数据文件（立即使用）
```
data/strict/
├── pair_train.csv      (970行，训练特征)
├── pair_val.csv        (242行，验证特征)
├── pair_test.csv       (243行，测试特征)
├── train_stats.json    (冻结参数)
└── pair_all.csv        (原始合并数据)
```

---

## 📊 核心数据一览

| 项目 | 数值 |
|------|------|
| **数据时间范围** | 2020-01-02 至 2025-12-31 |
| **总样本数** | 1455 行 |
| **训练集** | 970 行 (66.7%, 2020-2023) |
| **验证集** | 242 行 (16.6%, 2024) |
| **测试集** | 243 行 (16.7%, 2025) |
| **协整性** | ✓ 显著 (p=0.000339) |
| **配对可行性** | **高** |

---

## 🔬 研究流程详解

### 第一步：数据获取 ✓
- 来源：AKShare API (前复权日K线)
- 文件：`data/strict/ICBC_601398.csv`, `CCB_601939.csv`
- 验证：1455行数据无缺失，完整覆盖目标时间段

### 第二步：防泄露处理 ✓
关键机制：
- **时间严格切分**：不随机，按历史顺序划分 (70/15/15)
- **参数冻结**：所有统计参数仅基于训练集计算
- **特征因果性**：验证集/测试集特征使用历史数据计算，无未来信息
- **输出**：`pair_train.csv`, `pair_val.csv`, `pair_test.csv`, `train_stats.json`

### 第三步：协整检验 ✓
- **方法**：Engle-Granger Two-Step
- **结果**：显著共整合 (检验统计量=-4.826, p<0.001)
- **意义**：两只股票存在长期均衡关系，配对交易有理论基础
- **文件**：`results/coint_test_*.json/txt`

### 第四步：报告生成 ✓
输出7个结果文件，包含完整的统计数据和对比分析

---

## 📁 文件导览

### 可执行脚本
| 脚本 | 功能 | 运行时间 |
|------|------|---------|
| `run_strict_research.py` | 执行完整研究流程 | 2分钟 |
| `generate_comparison_report.py` | 生成对标分析 | <1分钟 |
| `view_results.py` | 快速查看结果 | <1秒 |

### 文档文件
| 文档 | 内容 | 阅读时间 |
|------|------|---------|
| `EXECUTION_REPORT.md` | 执行完成报告，包含流程和结果 | 10分钟 |
| `RESEARCH_SUMMARY.md` | 详细研究总结，包含方法论检查 | 15分钟 |
| `README_COMMANDS.md` | 常用命令速查表 | 2分钟 |

### 数据文件
| 文件 | 行数 | 列数 | 用途 |
|------|------|------|------|
| `data/strict/pair_train.csv` | 970 | 11 | 训练用特征集 |
| `data/strict/pair_val.csv` | 242 | 11 | 验证用特征集 |
| `data/strict/pair_test.csv` | 243 | 11 | 测试用特征集 |
| `data/strict/pair_all.csv` | 1455 | 6 | 原始合并数据 |
| `data/strict/train_stats.json` | - | - | 冻结的统计参数 |

### 结果文件
| 文件 | 格式 | 内容 |
|------|------|------|
| `工商银行_建设银行_ICBC_CCB_report.json` | JSON | 完整研究报告 |
| `research_summary_report.json` | JSON | 总结报告 |
| `coint_test_*.json` | JSON | 协整检验详细结果 |
| `coint_test_*.txt` | TXT | 协整检验简化结果 |
| `data_split_log.json` | JSON | 数据划分日志 |
| `data_structure_comparison.csv` | CSV | 数据结构对比 |

---

## 📈 关键指标

### 防泄露验证 ✓
- ✓ 时间边界严格划分（无重叠）
- ✓ 参数仅基于训练集
- ✓ 验证/测试特征使用历史数据
- ✓ 无前向偏差(look-ahead bias)
- ✓ 无参数优化泄露

### 特征质量 ✓
| 特征 | 均值 | 标准差 | 范围 |
|------|------|--------|------|
| zscore | -0.138 | 1.228 | [-3.77, 3.42] |
| price_spread | -0.997 | 0.222 | [-1.60, -0.50] |
| price_ratio | 0.780 | 0.030 | [0.71, 0.87] |

### 统计显著性 ✓
- 协整检验p值: **3.39×10⁻⁴** (远小于0.05)
- 显著性水平: **α=0.01** (非常强)
- 配对有效性: **已验证**

---

## 🔄 重新运行研究

如需重新执行研究流程：

```bash
# 执行完整研究
python run_strict_research.py

# 生成对比报告
python generate_comparison_report.py

# 查看结果
python view_results.py
```

预期耗时：2分钟  
输出位置：`results/` 目录

---

## 💡 下一步建议

1. **模型训练**（推荐）
   ```bash
   cd ../..
   python 03_train_ppo_model.py \
     --data_path research/ICBC_CCB_research/data/strict/pair_train.csv
   ```

2. **性能评估**
   - 使用生成的特征集训练PPO模型
   - 与基准模型(宁德/比亚迪)对标

3. **风险分析**
   - 分析策略的夏普比率
   - 计算最大回撤

4. **参数优化**
   - 优化布林带参数
   - 调整交易信号阈值

---

## ✅ 质量检查清单

- ✓ 数据完整性：1455行，无缺失值
- ✓ 时间连续性：2020-2025，6年连续交易日
- ✓ 防泄露机制：多层防护，完全隔离
- ✓ 统计显著性：p<0.001，高度显著
- ✓ 可复现性：完全开源，使用公开数据
- ✓ 文档完整性：详细的执行报告和研究总结
- ✓ 结果可用性：所有中间数据已保存，可直接用于模型训练

---

## 📞 常见问题

**Q: 如何查看原始数据？**  
A: 打开 `data/strict/pair_all.csv`，包含两只股票的合并基础数据

**Q: 如何验证防泄露机制？**  
A: 阅读 [RESEARCH_SUMMARY.md](RESEARCH_SUMMARY.md) 中的"防泄露机制验证"部分

**Q: 能否修改数据划分比例？**  
A: 可以，编辑 `run_strict_research.py` 中的 `TRAIN_END` 和 `VAL_END` 参数

**Q: 协整检验的意义是什么？**  
A: p值0.000339表示两只股票高度相关，配对交易在理论上是可行的

**Q: 如何使用这些数据进行模型训练？**  
A: 直接使用 `pair_train.csv` 的11列特征，target应为收益率或价差信号

---

## 📄 文档阅读顺序

1. **快速了解** (2分钟)
   - 本文档的"核心数据一览"和"关键指标"

2. **深入理解** (10分钟)
   - [EXECUTION_REPORT.md](EXECUTION_REPORT.md)

3. **严谨验证** (15分钟)
   - [RESEARCH_SUMMARY.md](RESEARCH_SUMMARY.md) 的"方法论完整性检查"

4. **查看数据** (1分钟)
   - 运行 `python view_results.py`

---

**最后更新**: 2026-02-11 19:02:04  
**项目状态**: ✓ 研究完成，所有数据已就绪  
**下一步**: 准备模型训练
